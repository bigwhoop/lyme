/*! LYME v1.2.4 (2013-05-19) with Markdown Extra and scroll_to plugin | http://bigwhoop.github.io/lyme | MIT License */

/**
 * The following libraries are included in this file:
 *
 * - JS Markdown Extra, Copyright (c) 2006 js-markdown-extra developers, https://github.com/tanakahisateru/js-markdown-extra
 */

function Markdown(text){var parser;return arguments.callee.parser===void 0?(parser=eval("new "+MARKDOWN_PARSER_CLASS+"()"),parser.init(),arguments.callee.parser=parser):parser=arguments.callee.parser,parser.transform(text)}function Markdown_Parser(){this.nested_brackets_depth=6,this.nested_url_parenthesis_depth=4,this.escape_chars="\\\\`*_{}[]()>#+-.!",this.document_gamut=[["stripLinkDefinitions",20],["runBasicBlockGamut",30]],this.block_gamut=[["doHeaders",10],["doHorizontalRules",20],["doLists",40],["doCodeBlocks",50],["doBlockQuotes",60]],this.span_gamut=[["parseSpan",-30],["doImages",10],["doAnchors",20],["doAutoLinks",30],["encodeAmpsAndAngles",40],["doItalicsAndBold",50],["doHardBreaks",60]],this.em_relist=[["","(?:(^|[^\\*])(\\*)(?=[^\\*])|(^|[^_])(_)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["*","((?:\\S|^)[^\\*])(\\*)(?!\\*)"],["_","((?:\\S|^)[^_])(_)(?!_)"]],this.strong_relist=[["","(?:(^|[^\\*])(\\*\\*)(?=[^\\*])|(^|[^_])(__)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["**","((?:\\S|^)[^\\*])(\\*\\*)(?!\\*)"],["__","((?:\\S|^)[^_])(__)(?!_)"]],this.em_strong_relist=[["","(?:(^|[^\\*])(\\*\\*\\*)(?=[^\\*])|(^|[^_])(___)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["***","((?:\\S|^)[^\\*])(\\*\\*\\*)(?!\\*)"],["___","((?:\\S|^)[^_])(___)(?!_)"]]}function MarkdownExtra_Parser(){this.fn_id_prefix="",this.fn_link_title=MARKDOWN_FN_LINK_TITLE,this.fn_backlink_title=MARKDOWN_FN_BACKLINK_TITLE,this.fn_link_class=MARKDOWN_FN_LINK_CLASS,this.fn_backlink_class=MARKDOWN_FN_BACKLINK_CLASS,this.predef_abbr={},this.footnotes={},this.footnotes_ordered=[],this.abbr_desciptions={},this.abbr_word_re="",this.footnote_counter=1,this.block_tags_re="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|address|form|fieldset|iframe|hr|legend",this.context_block_tags_re="script|noscript|math|ins|del",this.contain_span_tags_re="p|h[1-6]|li|dd|dt|td|th|legend|address",this.clean_tags_re="script|math",this.auto_close_tags_re="hr|img",this.em_relist=[["","(?:(^|[^\\*])(\\*)(?=[^\\*])|(^|[^a-zA-Z0-9_])(_)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["*","((?:\\S|^)[^\\*])(\\*)(?!\\*)"],["_","((?:\\S|^)[^_])(_)(?![a-zA-Z0-9_])"]],this.strong_relist=[["","(?:(^|[^\\*])(\\*\\*)(?=[^\\*])|(^|[^a-zA-Z0-9_])(__)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["**","((?:\\S|^)[^\\*])(\\*\\*)(?!\\*)"],["__","((?:\\S|^)[^_])(__)(?![a-zA-Z0-9_])"]],this.em_strong_relist=[["","(?:(^|[^\\*])(\\*\\*\\*)(?=[^\\*])|(^|[^a-zA-Z0-9_])(___)(?=[^_]))(?=\\S|$)(?![\\.,:;]\\s)"],["***","((?:\\S|^)[^\\*])(\\*\\*\\*)(?!\\*)"],["___","((?:\\S|^)[^_])(___)(?![a-zA-Z0-9_])"]],this.escape_chars+=":|",this.document_gamut.push(["doFencedCodeBlocks",5]),this.document_gamut.push(["stripFootnotes",15]),this.document_gamut.push(["stripAbbreviations",25]),this.document_gamut.push(["appendFootnotes",50]),this.block_gamut.push(["doFencedCodeBlocks",5]),this.block_gamut.push(["doTables",15]),this.block_gamut.push(["doDefLists",45]),this.span_gamut.push(["doFootnotes",5]),this.span_gamut.push(["doAbbreviations",70])}$.fn.lyme=function(t){var e={markup:"",onMarkupChange:null,onPreInit:null,onPostInit:null,renderer:new $.fn.lyme.renderers.JSMarkdownExtra,plugins:[new $.fn.lyme.plugins.ScrollTo],hotKeys:$.fn.lyme.hotKeys},n=$.extend(e,t);if(n.markup instanceof $){var r=n.markup;n.plugins.push(new $.fn.lyme.plugins.TextareaAdapter(r))}n.plugins.forEach(function(t){$.isFunction(t.onGetMarkup)&&(n.markup=t.onGetMarkup())});var i={};if($.each(["onMarkupChange","onPreInit","onPostInit"],function(){$.isFunction(n[this])&&(i[this]=n[this])}),n.plugins.push(i),1==this.length)return new $.fn.lyme.Editor($(this),n);var a={};return this.each(function(){a[this.selector]=new $.fn.lyme.Editor($(this),n)}),a},$.fn.lyme.Editor=function(t,e){function n(){t.on("click",function(t){t.stopPropagation()}),$(document).on("click",function(){a.hideEditor()}),e.plugins.forEach(function(t){$.isFunction(t.setEditor)&&t.setEditor(a)}),r("onPreInit",[t,e]),a.setMarkup(e.markup),r("onPostInit",[a.getFullMarkup(),a.getFullHTML()])}function r(t,n){$.isArray(n)||(n=[]),e.plugins.forEach(function(e){$.isFunction(e[t])&&e[t].apply(null,n)})}function i(){return o++}var a=this;a.setRenderer=function(t){e.renderer=t},a.splitMarkup=function(t){return $.isFunction(e.renderer.split)?e.renderer.split(t):t.replace(/\r/g,"").replace(/\n\n\n/g,"\n\n").split("\n\n")};var o=0;a.createBlock=function(t,n){function o(t){var n=p.val(),i=h;return $.each(a.splitMarkup(n),function(t,n){var r=e.renderer.render(n);if(0==t)p.val(n),l.html(r);else{var o=a.createBlock(n,r);i.after(o.getElement()),i=o.getElement()}}),t!=n&&r("onMarkupChange",[a.getFullMarkup(),a.getFullHTML()]),n}n||(n=e.renderer.render(t));var s=i(),h=$('<div id="lyme-block-'+s+'" class="lyme-block">'),u=$('<div class="markup"></div>'),p=$("<textarea></textarea>"),l=$('<div class="preview"></div>');p.val(t),l.html(n),u.hide().append(p),h.append(u).append(l);var c=new $.fn.lyme.Block(h);return p.on("focusout",function(){r("onPreStopEditing",[c]),""==p.val()&&h.remove(),t=o(t),r("onPostStopEditing",[c])}),p.on("keydown",function(t){for(var n in e.hotKeys){var r=e.hotKeys[n];r.if(t)&&(t.preventDefault(),r.do(a,c))}}),l.on("click",function(){a.hideEditor(),r("onPreStartEditing",[c]),l.hide(),u.show(),p.focus(),r("onPostStartEditing",[c])}),c},a.getFullMarkup=function(){var e=[];return t.find(".lyme-block .markup textarea").each(function(){e.push($(this).val())}),e.join("\r\n\r\n")},a.getFullHTML=function(){return e.renderer.render(a.getFullMarkup())},a.setMarkup=function(e){t.empty(),$.each(a.splitMarkup(e),function(e,n){var r=a.createBlock(n);t.append(r.getElement())})},a.getElement=function(){return t},a.hideEditor=function(){t.find(".lyme-block .markup:visible textarea").blur(),t.find(".lyme-block .markup:visible").hide(),t.find(".lyme-block .preview").show()},n()},$.fn.lyme.Block=function(t){this.edit=function(){t.find(".preview").trigger("click")},this.getPreviousBlock=function(){var e=t.prev();return e.length?new $.fn.lyme.Block(e):!1},this.getNextBlock=function(){var e=t.next();return e.length?new $.fn.lyme.Block(e):!1},this.getMarkup=function(){return t.find("textarea").val()},this.setMarkup=function(e){t.find("textarea").val(e)},this.getElement=function(){return t}},$.fn.lyme.renderers={JSMarkdownExtra:function(){var t;this.render=function(e){return t||(t=new MarkdownExtra_Parser,t.init()),t.transform(e)},this.split=function(t){for(var e=t.replace(/\r/g,"").replace(/\n\n\n/g,"\n\n").split("\n\n"),n=[],r=[],i=0;e.length>i;i++)0==r.length?e[i].indexOf("~~~")>-1?r.push(e[i]):n.push(e[i]):(r.push(e[i]),e[i].indexOf("~~~")>-1&&(n.push(r.join("\n\n")),r=[]));return r.length&&n.push(r.join("\n\n")),n}},Showdown:function(){var t;this.render=function(e){return t||(t=new Showdown.converter),t.makeHtml(e)}}},$.fn.lyme.hotKeys={tabbing:{indentation:"    ","if":function(t){return 9==t.keyCode},"do":function(t,e){var n=e.getElement().find("textarea").get(0),r=n.selectionStart;n.value=n.value.substring(0,n.selectionStart)+this.indentation+n.value.substring(n.selectionEnd,n.value.length),setTimeout(function(){n.focus(),n.setSelectionRange(r+4,r+4)},0)}},escape:{"if":function(t){return 27==t.keyCode},"do":function(t){t.hideEditor()}},"place-before":{"if":function(t){return t.altKey&&t.ctrlKey&&t.shiftKey&&38==t.keyCode},"do":function(t,e){var n=e.getPreviousBlock();if(n){var r=e.getMarkup(),i=n.getMarkup();e.setMarkup(i),n.setMarkup(r),n.edit()}}},"place-after":{"if":function(t){return t.altKey&&t.ctrlKey&&t.shiftKey&&40==t.keyCode},"do":function(t,e){var n=e.getNextBlock();if(n){var r=e.getMarkup(),i=n.getMarkup();e.setMarkup(i),n.setMarkup(r),n.edit()}}},"move-up":{"if":function(t){return t.altKey&&t.ctrlKey&&38==t.keyCode},"do":function(t,e){var n=e.getPreviousBlock();n&&n.edit()}},"move-down":{"if":function(t){return t.altKey&&t.ctrlKey&&40==t.keyCode},"do":function(t,e){var n=e.getNextBlock();n&&n.edit()}},"append-empty-block":{"if":function(t){return t.altKey&&t.ctrlKey&&13==t.keyCode},"do":function(t,e){var n=t.createBlock("","");e.getElement().after(n.getElement()),n.edit()}},"remove-block":{"if":function(t){return t.altKey&&t.ctrlKey&&8==t.keyCode},"do":function(t,e){e.setMarkup("");var n=e.getPreviousBlock(),r=e.getNextBlock();n?n.edit():r?r.edit():t.hideEditor()}}},$.fn.lyme.plugins={ContentGuard:function(t,e){var n=!1,t="boolean"==typeof t?t:!0,e="boolean"==typeof e?e:!0;this.enable=function(){e=!0},this.disable=function(){e=!1},t&&$(document).on("submit","form",function(){e=!1}),this.onMarkupChange=function(){n=!0},$(window).bind("beforeunload",function(){return e&&n?"Are you sure you want to leave this page?":void 0})},TextareaAdapter:function(t,e){var n=$(t);this.onGetMarkup=function(){return n.val()},this.onMarkupChange=function(t,r){n.val(e?r:t)}},AjaxAdapter:function(t,e){t&&t.length&&(this.onGetMarkup=function(){var e="Failed to retrieve the from "+t;return $.ajax({url:t,type:"get",success:function(t){e=t},async:!1}),e}),e&&e.length&&(this.onMarkupChange=function(t,n){$.ajax({url:e,data:{markup:t,html:n},type:"post"})})},ScrollTo:function(t,e){$.isNumeric(t)||(t=300),$.isNumeric(e)||(e=50);var n;this.onPreStartEditing=function(r){window.clearTimeout(n),n=window.setTimeout(function(){$("html, body").animate({scrollTop:r.getElement().offset().top-e},750)},t)}}},$.fn.lyme.plugins.UndoRedo=function(t){var e;switch(t){case"localStorage":e=new $.fn.lyme.plugins.UndoRedo.LocalStorage;break;case"memory":default:e=new $.fn.lyme.plugins.UndoRedo.MemoryStorage}var n;this.setEditor=function(t){n=t},this.undo=function(){n.setMarkup(e.undo())},this.redo=function(){n.setMarkup(e.redo())},this.onPostInit=function(t){n.setMarkup(e.init(t))},this.onMarkupChange=function(t){e.push(t)}},$.fn.lyme.plugins.UndoRedo.LocalStorage=function(){function t(){localStorage.setItem(e,JSON.stringify(n))}const e="lyme";var n=new $.fn.lyme.plugins.UndoRedo.MemoryStorage,r=localStorage.getItem(e);r&&(persistedStorageObj=JSON.parse(r))&&(n.pointer=persistedStorageObj.pointer,n.entries=persistedStorageObj.entries),this.init=function(e){var r=n.getMarkup();if(r)return r;var i=n.init(e);return t(),i},this.push=function(e){n.push(e),t()},this.undo=function(){var e=n.undo();return t(),e},this.redo=function(){var e=n.redo();return t(),e}},$.fn.lyme.plugins.UndoRedo.MemoryStorage=function(){this.pointer=0,this.entries=[],this.init=function(t){return this.push(t),t},this.push=function(t){this.entries=this.entries.slice(0,this.pointer),this.entries[this.pointer++]=t},this.undo=function(){return this.pointer--,1>this.pointer&&(this.pointer=1),this.getMarkup()},this.redo=function(){return this.pointer++,this.pointer>this.entries.length&&(this.pointer=this.entries.length),this.getMarkup()},this.getMarkup=function(){return this.entries[this.pointer-1]}};var MARKDOWN_VERSION="1.0.1o",MARKDOWNEXTRA_VERSION="1.2.5",MARKDOWN_EMPTY_ELEMENT_SUFFIX=" />",MARKDOWN_TAB_WIDTH=4,MARKDOWN_FN_LINK_TITLE="",MARKDOWN_FN_BACKLINK_TITLE="",MARKDOWN_FN_LINK_CLASS="",MARKDOWN_FN_BACKLINK_CLASS="",MARKDOWN_WP_POSTS=!0,MARKDOWN_WP_COMMENTS=!0;MARKDOWN_PARSER_CLASS="MarkdownExtra_Parser",Markdown_Parser.prototype.init=function(){function t(t,e){return t=t[1],e=e[1],t>e?1:e>t?-1:0}this.prepareItalicsAndBold(),this.nested_brackets_re=this._php_str_repeat("(?:[^\\[\\]]+|\\[",this.nested_brackets_depth)+this._php_str_repeat("\\])*",this.nested_brackets_depth),this.nested_url_parenthesis_re=this._php_str_repeat("(?:[^\\(\\)\\s]+|\\(",this.nested_url_parenthesis_depth)+this._php_str_repeat("(?:\\)))*",this.nested_url_parenthesis_depth);for(var e=[],n=0;this.escape_chars.length>n;n++)e.push(this._php_preg_quote(this.escape_chars.charAt(n)));this.escape_chars_re="["+e.join("")+"]",this.empty_element_suffix=MARKDOWN_EMPTY_ELEMENT_SUFFIX,this.tab_width=MARKDOWN_TAB_WIDTH,this.no_markup=!1,this.no_entities=!1,this.predef_urls={},this.predef_titles={},this.document_gamut.sort(t),this.block_gamut.sort(t),this.span_gamut.sort(t),this.urls={},this.titles={},this.html_hashes={},this.in_anchor=!1},Markdown_Parser.prototype.__wrapSTXETX__=function(t){return""!=t.charAt(0)&&(t=""+t),""!=t.charAt(t.length-1)&&(t+=""),t},Markdown_Parser.prototype.__unwrapSTXETX__=function(t){return""==t.charAt(0)&&(t=t.substr(1)),""==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),t},Markdown_Parser.prototype._php_preg_quote=function(t){return arguments.callee.sRE||(arguments.callee.sRE=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}\\)/g),t.replace(arguments.callee.sRE,"\\$1")},Markdown_Parser.prototype._php_str_repeat=function(t,e){for(var n=t,r=1;e>r;r++)n+=t;return n},Markdown_Parser.prototype._php_trim=function(t,e){var n=e||" 	\n\r";return t.replace(RegExp("^["+n+"]*|["+n+"]*$","g"),"")},Markdown_Parser.prototype._php_rtrim=function(t,e){var n=e||" 	\n\r";return t.replace(RegExp("["+n+"]*$","g"),"")},Markdown_Parser.prototype._php_htmlspecialchars_ENT_NOQUOTES=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},Markdown_Parser.prototype.setup=function(){this.urls=this.predef_urls,this.titles=this.predef_titles,this.html_hashes={},this.in_anchor=!1},Markdown_Parser.prototype.teardown=function(){this.urls={},this.titles={},this.html_hashes={}},Markdown_Parser.prototype.transform=function(t){this.setup(),t=t.replace(/^\xEF\xBB\xBF|\x1A/,""),t=t.replace(/\r\n?/g,"\n",t),t+="\n\n",t=this.detab(t),t=this.hashHTMLBlocks(t),t=t.replace(/^[ ]+$/m,"");for(var e=0;this.document_gamut.length>e;e++){var n=this[this.document_gamut[e][0]];n?t=n.call(this,t):console.log(this.document_gamut[e][0]+" not implemented")}return this.teardown(),t+"\n"},Markdown_Parser.prototype.hashHTMLBlocks=function(t){if(this.no_markup)return t;var e=this.tab_width-1,n="ins|del",r="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|address|script|noscript|form|fieldset|iframe|math",i=4,a='(?:\\s(?:[^>"/]+|/+(?!>)|"[^"]*"|\'[^\']*\')*)?',o=this._php_str_repeat("(?:[^<]+|<\\2"+a+"(?:"+"/>"+"|"+">",i)+".*?"+this._php_str_repeat("</\\2\\s*>)|<(?!/\\2\\s*>))*",i),s=o.replace("\\2","\\3"),h=RegExp("(?:(?:(?:\\n\\n)|(?:\\x02)\\n?)([ ]{0,"+e+"}"+"<("+r+")"+a+">"+o+"</\\2>"+"[ ]*"+"(?=\\n+|\\n*\\x03)"+"|"+"[ ]{0,"+e+"}"+"<("+n+")"+a+">[ ]*\\n"+s+"</\\3>"+"[ ]*"+"(?=\\n+|\\n*\\x03)"+"|"+"[ ]{0,"+e+"}"+"<(hr)"+a+"/?>"+"[ ]*"+"(?=\\n{2,}|\\n*\\x03)"+"|"+"[ ]{0,"+e+"}"+"(?:"+"<!--.*?-->"+")"+"[ ]*"+"(?=\\n{2,}|\\n*\\x03)"+"|"+"[ ]{0,"+e+"}"+"(?:"+"<([?%])"+".*?"+"\\2>"+")"+"[ ]*"+"(?=\\n{2,}|\\n*\\x03)"+")"+")","mig"),u=this;return t=this.__wrapSTXETX__(t),t=t.replace(h,function(t,e){var n=u.hashBlock(e);return"\n\n"+n+"\n\n"}),t=this.__unwrapSTXETX__(t)},Markdown_Parser.prototype.hashPart=function(t,e){e===void 0&&(e="X"),t=this.unhash(t),arguments.callee.i===void 0&&(arguments.callee.i=0);var n=e+""+ ++arguments.callee.i+e;return this.html_hashes[n]=t,n},Markdown_Parser.prototype.hashBlock=function(t){return this.hashPart(t,"B")},Markdown_Parser.prototype.stripLinkDefinitions=function(t){var e=this.tab_width-1,n=this;return t=this.__wrapSTXETX__(t),t=t.replace(RegExp("^[ ]{0,"+e+"}\\[(.+)\\][ ]?:"+"[ ]*"+"\\n?"+"[ ]*"+"(?:"+"<(.+?)>"+"|"+"(\\S+?)"+")"+"[ ]*"+"\\n?"+"[ ]*"+"(?:"+'["\\(]'+"(.*?)"+'["\\)]'+"[ ]*"+")?"+"(?:\\n+|\\n*(?=\\x03))","mg"),function(t,e,r,i,a){var o=e.toLowerCase(),s=r?r:i;return n.urls[o]=s,n.titles[o]=a,""}),t=this.__unwrapSTXETX__(t)},Markdown_Parser.prototype.runBlockGamut=function(t){return t=this.hashHTMLBlocks(t),this.runBasicBlockGamut(t)},Markdown_Parser.prototype.runBasicBlockGamut=function(t){for(var e=0;this.block_gamut.length>e;e++){var n=this[this.block_gamut[e][0]];n?t=n.call(this,t):console.log(this.block_gamut[e][0]+" not implemented")}return t=this.formParagraphs(t)},Markdown_Parser.prototype.doHorizontalRules=function(t){var e=this;return t.replace(RegExp("^[ ]{0,3}([-\\*_])(?:[ ]{0,2}\\1){2,}[ ]*$","mg"),function(){return"\n"+e.hashBlock("<hr"+e.empty_element_suffix)+"\n"})},Markdown_Parser.prototype.runSpanGamut=function(t){for(var e=0;this.span_gamut.length>e;e++){var n=this[this.span_gamut[e][0]];n?t=n.call(this,t):console.log(this.span_gamut[e][0]+" not implemented")}return t},Markdown_Parser.prototype.doHardBreaks=function(t){var e=this;return t.replace(/ {2,}\n/gm,function(){return e.hashPart("<br"+e.empty_element_suffix+"\n")})},Markdown_Parser.prototype.doAnchors=function(t){if(this.in_anchor)return t;this.in_anchor=!0;var e=this,n=function(t,n,r,i){("string"!=typeof i||""===i)&&(i=r),i=i.toLowerCase(),i=i.replace(/[ ]?\n/," ");var a;if(e.urls[i]!==void 0){var o=e.urls[i];if(o=e.encodeAttribute(o),a='<a href="'+o+'"',e.titles[i]!==void 0){var s=e.titles[i];s=e.encodeAttribute(s),a+=' title="'+s+'"'}r=e.runSpanGamut(r),a+=">"+r+"</a>",a=e.hashPart(a)}else a=n;return a};return t=t.replace(RegExp("(\\[("+this.nested_brackets_re+")"+"\\]"+"[ ]?"+"(?:\\n[ ]*)?"+"\\["+"(.*?)"+"\\]"+")","mg"),n),t=t.replace(RegExp("(\\[("+this.nested_brackets_re+")"+"\\]"+"\\("+"[ \\n]*"+"(?:"+"<(.+?)>"+"|"+"("+this.nested_url_parenthesis_re+")"+")"+"[ \\n]*"+"("+"(['\"])"+"(.*?)"+"\\6"+"[ \\n]*"+")?"+"\\)"+")","mg"),function(t,n,r,i,a,o,s,h){r=e.runSpanGamut(r);var u=i?i:a;u=e.encodeAttribute(u);var p='<a href="'+u+'"';return h!==void 0&&""!==h&&(h=e.encodeAttribute(h),p+=' title="'+h+'"'),r=e.runSpanGamut(r),p+=">"+r+"</a>",e.hashPart(p)}),t=t.replace(RegExp("(\\[([^\\[\\]]+)\\])","mg"),n),this.in_anchor=!1,t},Markdown_Parser.prototype.doImages=function(t){var e=this;return t=t.replace(RegExp("(!\\[("+this.nested_brackets_re+")"+"\\]"+"[ ]?"+"(?:\\n[ ]*)?"+"\\["+"(.*?)"+"\\]"+")","mg"),function(t,n,r,i){i=i.toLowerCase(),("string"!=typeof i||""===i)&&(i=r.toLowerCase()),r=e.encodeAttribute(r);var a;if(e.urls[i]!==void 0){var o=e.encodeAttribute(e.urls[i]);if(a='<img src="'+o+'" alt="'+r+'"',e.titles[i]!==void 0){var s=e.titles[i];s=e.encodeAttribute(s),a+=' title="'+s+'"'}a+=e.empty_element_suffix,a=e.hashPart(a)}else a=n;return a}),t=t.replace(RegExp("(!\\[("+this.nested_brackets_re+")"+"\\]"+"\\s?"+"\\("+"[ \\n]*"+"(?:"+"<(\\S*)>"+"|"+"("+this.nested_url_parenthesis_re+")"+")"+"[ \\n]*"+"("+"(['\"])"+"(.*?)"+"\\6"+"[ \\n]*"+")?"+"\\)"+")","mg"),function(t,n,r,i,a,o,s,h){var u=i?i:a;r=e.encodeAttribute(r),u=e.encodeAttribute(u);var p='<img src="'+u+'" alt="'+r+'"';return h!==void 0&&""!==h&&(h=e.encodeAttribute(h),p+=' title="'+h+'"'),p+=e.empty_element_suffix,e.hashPart(p)})},Markdown_Parser.prototype.doHeaders=function(t){var e=this;return t=t.replace(/^(.+?)[ ]*\n(=+|-+)[ ]*\n+/gm,function(t,n,r){if("-"==r&&n.match(/^-(?: |$)/))return t;var i="="==r.charAt(0)?1:2,a="<h"+i+">"+e.runSpanGamut(n)+"</h"+i+">";return"\n"+e.hashBlock(a)+"\n\n"}),t=t.replace(RegExp("^(\\#{1,6})[ ]*(.+?)[ ]*\\#*\\n+","mg"),function(t,n,r){var i=n.length,a="<h"+i+">"+e.runSpanGamut(r)+"</h"+i+">";return"\n"+e.hashBlock(a)+"\n\n"})},Markdown_Parser.prototype.doLists=function(t){for(var e=this.tab_width-1,n="[\\*\\+-]",r="\\d+[\\.]",i=this,a=function(t,e,a,o,s){var h=s.match(n)?"ul":"ol",u="ul"==h?n:r;e+="\n";var p=i.processListItems(e,u);return p=i.hashBlock("<"+h+">\n"+p+"</"+h+">"),"\n"+p+"\n\n"},o=[[n,r],[r,n]],s=0;o.length>s;s++){var h=o[s][0],u=o[s][1],p="((([ ]{0,"+e+"})"+"("+h+")"+"[ ]+"+")"+"[\\s\\S]+?"+"("+"(?=\\x03)"+"|"+"\\n{2,}"+"(?=\\S)"+"(?!"+"[ ]*"+h+"[ ]+"+")"+"|"+"(?="+"\\n"+"\\3"+u+"[ ]+"+")"+")"+")";t=this.__wrapSTXETX__(t),t=this.list_level?t.replace(RegExp("^"+p,"mg"),a):t.replace(RegExp("(?:(?=\\n)\\n|\\x02\\n?)"+p,"mg"),a),t=this.__unwrapSTXETX__(t)}return t},Markdown_Parser.prototype.processListItems=function(t,e){this.list_level===void 0&&(this.list_level=0),this.list_level++,t=this.__wrapSTXETX__(t),t=t.replace(/\n{2,}(?=\x03)/m,"\n"),t=this.__unwrapSTXETX__(t);var n=this;return t=this.__wrapSTXETX__(t),t=t.replace(RegExp("(\\n)?([ ]*)("+e+"(?:[ ]+|(?=\\n))"+")"+"([\\s\\S]*?)"+"(?:(\\n+(?=\\n))|\\n)"+"(?=\\n*(\\x03|\\2("+e+")(?:[ ]+|(?=\\n))))","gm"),function(t,e,r,i,a,o){return e||o||a.match(/\n{2,}/)?(a=r+n._php_str_repeat(" ",i.length)+a,a=n.runBlockGamut(n.outdent(a)+"\n")):(a=n.doLists(n.outdent(a)),a=a.replace(/\n+$/m,""),a=n.runSpanGamut(a)),"<li>"+a+"</li>\n"}),t=this.__unwrapSTXETX__(t),this.list_level--,t},Markdown_Parser.prototype.doCodeBlocks=function(t){var e=this;return t=this.__wrapSTXETX__(t),t=t.replace(RegExp("(?:\\n\\n|(?=\\x02)\\n?)((?:^[ ]{"+this.tab_width+",}"+".*\\n+"+")+"+")"+"((?=[ ]{0,"+this.tab_width+"}\\S)|(?:\\n*(?=\\x03)))","mg"),function(t,n){return n=e.outdent(n),n=e._php_htmlspecialchars_ENT_NOQUOTES(n),n=e.__wrapSTXETX__(n),n=n.replace(/(?=\x02)\n+|\n+(?=\x03)/g,""),n=e.__unwrapSTXETX__(n),n="<pre><code>"+n+"\n</code></pre>","\n\n"+e.hashBlock(n)+"\n\n"}),t=this.__unwrapSTXETX__(t)},Markdown_Parser.prototype.makeCodeSpan=function(t){return t=this._php_htmlspecialchars_ENT_NOQUOTES(this._php_trim(t)),this.hashPart("<code>"+t+"</code>")},Markdown_Parser.prototype.prepareItalicsAndBold=function(){this.em_strong_prepared_relist={};for(var t=0;this.em_relist.length>t;t++)for(var e=this.em_relist[t][0],n=this.em_relist[t][1],r=0;this.strong_relist.length>r;r++){for(var i=this.strong_relist[r][0],a=this.strong_relist[r][1],o=[],s=0;this.em_strong_relist.length>s;s++){var h=this.em_strong_relist[s][0],u=this.em_strong_relist[s][1];e+i==h&&o.push(u)}o.push(n),o.push(a);var p=RegExp("("+o.join("|")+")");this.em_strong_prepared_relist["rx_"+e+i]=p}},Markdown_Parser.prototype.doItalicsAndBold=function(t){for(var e="",n="",r=!1,i=[""],a=[],o="";;){var s=this.em_strong_prepared_relist["rx_"+e+n],h=t.match(s);if(h){for(var u=RegExp.leftContext,p=RegExp.rightContext,l="",c=h[1],_=2;h.length>_;_+=2)if(h[_]!==void 0&&""!=h[_]){l=h[_],c=h[_+1];break}i[0]+=u+l,o=c,t=p}else i[0]+=t,o="",t="";if(""==o){for(;a.length>0&&a[0].length>0;){i[1]+=a.shift();var d=i.shift();i[0]+=d}break}var f,g,m=o.length;if(r)3==m?(a.shift(),g=i.shift(),g=this.runSpanGamut(g),g="<strong><em>"+g+"</em></strong>",i[0]+=this.hashPart(g),e="",n=""):(a[0]=this._php_str_repeat(o.charAt(0),3-m),f=2==m?"strong":"em",g=i[0],g=this.runSpanGamut(g),g="<"+f+">"+g+"</"+f+">",i[0]=this.hashPart(g),"strong"==f?n="":e=""),r=!1;else if(3==m)if(""!=e)for(var k=0;2>k;++k){var E=a.shift();f=2==E.length?"strong":"em",g=i.shift(),g=this.runSpanGamut(g),g="<"+f+">"+g+"</"+f+">",i[0]=this.hashPart(g),"strong"==f?n="":e=""}else e=o.charAt(0),n=e+e,a.unshift(o),i.unshift(""),r=!0;else if(2==m)if(""!=n){if(1==a[0].length){i[1]+=a.shift();var d=i.shift();i[0]+=d}a.shift(),g=i.shift(),g=this.runSpanGamut(g),g="<strong>"+g+"</strong>",i[0]+=this.hashPart(g),n=""}else a.unshift(o),i.unshift(""),n=o;else""!=e?1==a[0].length?(a.shift(),g=i.shift(),g=this.runSpanGamut(g),g="<em>"+g+"</em>",i[0]+=this.hashPart(g),e=""):i[0]+=o:(a.unshift(o),i.unshift(""),e=o)}return i[0]},Markdown_Parser.prototype.doBlockQuotes=function(t){var e=this;return t=t.replace(RegExp("((?:^[ ]*>[ ]?.+\\n(.+\\n)*\\n*)+)","mg"),function(t,n){return n=n.replace(/^[ ]*>[ ]?|^[ ]+$/gm,""),n=e.runBlockGamut(n),n=n.replace(/^/gm,"  "),n=n.replace(/(\\s*<pre>[\\s\\S]+?<\/pre>)/gm,function(t,e){return e=e.replace(/^  /m,"")}),"\n"+e.hashBlock("<blockquote>\n"+n+"\n</blockquote>")+"\n\n"})},Markdown_Parser.prototype.formParagraphs=function(t){t=this.__wrapSTXETX__(t),t=t.replace(/(?:\x02)\n+|\n+(?:\x03)/g,""),t=this.__unwrapSTXETX__(t);for(var e=t.split(/\n{2,}/m),n=0;e.length>n;n++){var r=e[n];if(""==r);else if(r.match(/^B\x1A[0-9]+B$/)){var i=r,a=this.html_hashes[i];i=a,e[n]=i}else r=this.runSpanGamut(r),r=r.replace(/^([ ]*)/,"<p>"),r+="</p>",e[n]=this.unhash(r)}return e.join("\n\n")},Markdown_Parser.prototype.encodeAttribute=function(t){return t=this.encodeAmpsAndAngles(t),t=t.replace(/"/g,"&quot;")},Markdown_Parser.prototype.encodeAmpsAndAngles=function(t){return t=this.no_entities?t.replace(/&/g,"&amp;"):t.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/,"&amp;"),t=t.replace(/</g,"&lt;")},Markdown_Parser.prototype.doAutoLinks=function(t){var e=this;return t=t.replace(/<((https?|ftp|dict):[^'">\s]+)>/i,function(t,n){var r=e.encodeAttribute(n),i='<a href="'+r+'">'+r+"</a>";return e.hashPart(i)}),t=t.replace(RegExp('<(?:mailto:)?((?:[-!#$%&\'*+/=?^_`.{|}~\\w\\x80-\\xFF]+|".*?")\\@(?:[-a-z0-9\\x80-\\xFF]+(\\.[-a-z0-9\\x80-\\xFF]+)*\\.[a-z]+|\\[[\\d.a-fA-F:]+\\]))>',"i"),function(t,n){var r=e.encodeEmailAddress(n);return e.hashPart(r)})},Markdown_Parser.prototype.encodeEmailAddress=function(t){function e(t){var e=0;e=-1^e;for(var r=0;t.length>r;++r){var i=255&(e^t.charCodeAt(r)),a="0x"+n[i];e=e>>>8^a}return(-1^e)>>>0}arguments.callee.crctable===void 0&&(arguments.callee.crctable="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF "+"B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".split(" "));var n=arguments.callee.crctable;t="mailto:"+t;var r,i=[];for(r=0;t.length>r;r++)i.push(t.charAt(r));var a=Math.floor(Math.abs(e(t)/t.length));for(r=0;i.length>r;r++){var o=i[r],s=o.charCodeAt(0);if(128>s){var h=a*(1+r)%100;h>90&&"@"!=o||(i[r]=45>h?"&#x"+s.toString(16)+";":"&#"+s.toString(10)+";")}}t=i.join("");var u=i.splice(7,i.length-1).join("");return t='<a href="'+t+'">'+u+"</a>"},Markdown_Parser.prototype.parseSpan=function(t){for(var e="",n=RegExp("(\\\\"+this.escape_chars_re+"|"+"`+"+(this.no_markup?"":"|<!--.*?-->|<\\?.*?\\?>|<%.*?%>|<[/!$]?[-a-zA-Z0-9:_]+(?=\\s(?=[^\"'>]+|\"[^\"]*\"|'[^']*')*)?>")+")");;){var r=t.match(n);if(!r){e+=t;break}if(RegExp.leftContext&&(e+=RegExp.leftContext),"`"!=RegExp.lastMatch.charAt(0)||"\\"!=RegExp.leftContext.charAt(RegExp.leftContext.length-1)){var i=this.handleSpanToken(RegExp.lastMatch,RegExp.rightContext);e+=i[0],t=i[1]}else e+=RegExp.lastMatch,t=RegExp.rightContext}return e},Markdown_Parser.prototype.handleSpanToken=function(t,e){switch(t.charAt(0)){case"\\":return[this.hashPart("&#"+t.charCodeAt(1)+";"),e];case"`":if(e.match(RegExp("^([\\s\\S]*?[^`])"+this._php_preg_quote(t)+"(?!`)([\\s\\S]*)$","m"))){var n=RegExp.$1;e=RegExp.$2;var r=this.makeCodeSpan(n);return[this.hashPart(r),e]}return[t,e];default:return[this.hashPart(t),e]}},Markdown_Parser.prototype.outdent=function(t){return t.replace(RegExp("^(\\t|[ ]{1,"+this.tab_width+"})","mg"),"")},Markdown_Parser.prototype.detab=function(t){var e=this;return t.replace(/^.*\t.*$/gm,function(t){var n=t.split("	");t=n.shift();for(var r=0;n.length>r;r++){var i=n[r],a=e.tab_width-t.length%e.tab_width;t+=e._php_str_repeat(" ",a)+i}return t})},Markdown_Parser.prototype.unhash=function(t){var e=this;return t.replace(/(.)\x1A[0-9]+\1/g,function(t){return e.html_hashes[t]})},MarkdownExtra_Parser.prototype=new Markdown_Parser,MarkdownExtra_Parser.prototype.setup=function(){this.constructor.prototype.setup.call(this),this.footnotes={},this.footnotes_ordered=[],this.abbr_desciptions={},this.abbr_word_re="",this.footnote_counter=1;for(var t in this.predef_abbr){var e=this.predef_abbr[t];""!=this.abbr_word_re&&(this.abbr_word_re+="|"),this.abbr_word_re+=this._php_preg_quote(t),this.abbr_desciptions[t]=this._php_trim(e)}},MarkdownExtra_Parser.prototype.teardown=function(){this.footnotes={},this.footnotes_ordered=[],this.abbr_desciptions={},this.abbr_word_re="",this.constructor.prototype.teardown.call(this)},MarkdownExtra_Parser.prototype.hashHTMLBlocks=function(t){var e=this._hashHTMLBlocks_inMarkdown(t);return t=e[0]},MarkdownExtra_Parser.prototype._hashHTMLBlocks_inMarkdown=function(t,e,n,r){if(e===void 0&&(e=0),n===void 0&&(n=""),r===void 0&&(r=!1),""===t)return["",""];var i,a=/(?:^\n?|\n\n)*$/,o=RegExp("^([ ]*<!--.*?-->)?[ ]*\\n","m"),s=RegExp("(</?("+this.block_tags_re+"|"+this.context_block_tags_re+"|"+this.clean_tags_re+"|"+"(?!\\s)"+n+")"+"(?:"+"(?=[\\s\"'/a-zA-Z0-9])"+"("+'".*?"|'+"'.*?'|"+".+?"+")*?"+")?"+">"+"|"+"<!--.*?-->"+"|"+"<\\?.*?\\?>|<%.*?%>"+"|"+"<!\\[CDATA\\[.*?\\]\\]>"+"|"+"`+"+(r?"":"|(?:^[ ]*\\n|^|\\n[ ]*\\n)[ ]{"+(e+4)+"}[^\\n]*\\n"+"(?="+"(?:[ ]{"+(e+4)+"}[^\\n]*|[ ]*)\\n"+")*"+"|"+"(?:^|\\n)"+"[ ]{0,"+e+"}~~~+[ ]*\\n")+")","m"),h=0,u="";do{var p,l=t.match(s);if(p=l?[RegExp.leftContext,RegExp.lastMatch,RegExp.rightContext]:[t],r){var c=this.hashPart("",":"),_=c+"\n";p[0]=c+p[0].replace(/\n/g,_)+c}if(u+=p[0],!l){t="";break}var d=p[1];t=p[2];var f,g,m=this._php_preg_quote(d);if("`"==d.charAt(0))m=this._php_preg_quote(d),(i=t.match(RegExp("^(.+?|\\n[^\\n])*?[^`]"+m+"[^`]")))?(u+=d+i[0],t=t.substr(i[0].length)):u+=d;else if(d.match(RegExp("^\\n?[ ]{0,"+"}~"*(e+3))))m=this._php_preg_quote(this._php_trim(d)),(i=t.match(RegExp("^(?>.*\\n)+?[ ]{0,"+e+"}"+m+"[ ]*\\n")))?(u+=d+i[0],t=t.substr(i[0].length)):u+=d;else if("\n"==d.charAt(0)||" "==d.charAt(0))u+=d;else if(d.match(RegExp("^<(?:"+this.block_tags_re+")\\b"))||d.match(RegExp("^<(?:"+this.context_block_tags_re+")\\b"))&&u.match(a)&&t.match(o))f=this._hashHTMLBlocks_inHTML(d+t,this.hashBlock,!0),g=f[0],t=f[1],u+="\n\n"+g+"\n\n";else if(d.match(RegExp("^<(?:"+this.clean_tags_re+")\\b"))||"!"==d.charAt(1)||"?"==d.charAt(1))f=this._hashHTMLBlocks_inHTML(d+t,this.hashClean,!1),g=f[0],t=f[1],u+=g;else if(""!==n&&d.match(RegExp("^</?(?:"+n+")\\b"))){if("/"==d.charAt(1)?h--:"/"!=d.charAt(d.length-2)&&h++,0>h){t=d+t;break}u+=d}else u+=d}while(h>=0);return[u,t]},MarkdownExtra_Parser.prototype._hashHTMLBlocks_inHTML=function(t,e,n){if(""===t)return["",""];var r,i=RegExp("\\s*markdown\\s*=\\s*(?:([\"'])(.*?)\\1|([^\\s>]*))()"),a=RegExp("(</?[\\w:$]+(?:(?=[\\s\"'/a-zA-Z0-9])(?:\".*?\"|'.*?'|.+?)*?)?>|<!--.*?-->|<\\?.*?\\?>|<%.*?%>|<!\\[CDATA\\[.*?\\]\\]>)"),o=t,s=0,h="",u="",p="";(r=t.match(/^<([\w:$]*)\b/))&&(p=r[1]);do{var l=t.match(a);if(!l)return[o.charAt(0),o.substr(1)];var c=[RegExp.leftContext,RegExp.lastMatch,RegExp.rightContext];h+=c[0];var _=c[1];if(t=c[2],_.match(RegExp("^</?(?:"+this.auto_close_tags_re+")\\b"))||"!"==_.charAt(1)||"?"==_.charAt(1))h+=_;else{_.match(RegExp("^</?"+p+"\\b"))&&("/"==_.charAt(1)?s--:"/"!=_.charAt(_.length-2)&&s++);var d;if(n&&(d=_.match(i))&&(d[2]+d[3]).match(/^1|block|span$/)){_=_.replace(i,""),this.mode=d[2]+d[3];var f,g="span"==this.mode||"block"!=this.mode&&_.match(RegExp("^<(?:"+this.contain_span_tags_re+")\\b"));f=(r=h.match(/(?:^|\n)( *?)(?! ).*?$/))?r[1].length:0,h+=_,u+=e.call(this,h),r=_.match(/^<([\w:$]*)\b/);
var m=r[1],k=this._hashHTMLBlocks_inMarkdown(t,f,m,g);h=k[0],t=k[1],f>0&&(h=h.replace(RegExp("/^[ ]{1,"+f+"}","m"),"")),u+=g?h:"\n\n"+h+"\n\n",h=""}else h+=_}}while(s>0);return u+=e.call(this,h),[u,t]},MarkdownExtra_Parser.prototype.hashClean=function(t){return this.hashPart(t,"C")},MarkdownExtra_Parser.prototype.doHeaders=function(t){function e(t){return t===void 0||""==t?"":' id="'+t+'"'}var n=this;return t=t.replace(RegExp("(^.+?)(?:[ ]+\\{\\#([-_:a-zA-Z0-9]+)\\})?[ ]*\\n(=+|-+)[ ]*\\n+","mg"),function(t,r,i,a){if("-"==a&&r.match(/^- /))return t;var o="="==a.charAt(0)?1:2,s=e(i),h="<h"+o+s+">"+n.runSpanGamut(r)+"</h"+o+">";return"\n"+n.hashBlock(h)+"\n\n"}),t=t.replace(RegExp("^(\\#{1,6})[ ]*(.+?)[ ]*\\#*(?:[ ]+\\{\\#([-_:a-zA-Z0-9]+)\\})?\\n+","mg"),function(t,r,i,a){var o=r.length,s=e(a),h="<h"+o+s+">"+n.runSpanGamut(i)+"</h"+o+">";return"\n"+n.hashBlock(h)+"\n\n"})},MarkdownExtra_Parser.prototype.doTables=function(t){var e=this,n=this.tab_width-1,r=function(t,n,r,i){n=n.replace(/[|] *$/m,""),r=r.replace(/[|] *$/m,""),i=i.replace(/[|] *$/m,"");var a,o=[],s=r.split(/[ ]*[|][ ]*/);for(a=0;s.length>a;a++){var h=s[a];o[a]=h.match(/^ *-+: *$/)?' align="right"':h.match(/^ *:-+: *$/)?' align="center"':h.match(/^ *:-+ *$/)?' align="left"':""}n=e.parseSpan(n);var u=n.split(/ *[|] */),p=u.length,l="<table>\n";for(l+="<thead>\n",l+="<tr>\n",a=0;u.length>a;a++){var c=u[a];l+="  <th"+o[a]+">"+e.runSpanGamut(e._php_trim(c))+"</th>\n"}l+="</tr>\n",l+="</thead>\n";var _=e._php_trim(i,"\n").split("\n");l+="<tbody>\n";for(var d=0;_.length>d;d++){var f=_[d];f=e.parseSpan(f);for(var g=f.split(/ *[|] */,p);p>g.length;)g.push("");for(l+="<tr>\n",a=0;g.length>a;a++){var m=g[a];l+="  <td"+o[a]+">"+e.runSpanGamut(e._php_trim(m))+"</td>\n"}l+="</tr>\n"}return l+="</tbody>\n",l+="</table>",e.hashBlock(l)+"\n"};return t=this.__wrapSTXETX__(t),t=t.replace(RegExp("^[ ]{0,"+n+"}"+"[|]"+"(.+)\\n"+"[ ]{0,"+n+"}"+"[|]([ ]*[-:]+[-| :]*)\\n"+"("+"(?:"+"[ ]*"+"[|].*\\n"+")*"+")"+"(?=\\n|\\x03)","mg"),function(t,e,n,i){return i=i.replace(/^ *[|]/m,""),r.call(this,t,e,n,i)}),t=t.replace(RegExp("^[ ]{0,"+n+"}"+"(\\S.*[|].*)\\n"+"[ ]{0,"+n+"}"+"([-:]+[ ]*[|][-| :]*)\\n"+"("+"(?:"+".*[|].*\\n"+")*"+")"+"(?=\\n|\\x03)","mg"),r),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.doDefLists=function(t){var e=this,n=this.tab_width-1,r="(?:(([ ]{0,"+n+"}"+"((?:[ \\t]*\\S.*\\n)+)"+"\\n?"+"[ ]{0,"+n+"}:[ ]+"+")"+"([\\s\\S]+?)"+"("+"(?=\\0x03)"+"|"+"(?="+"\\n{2,}"+"(?=\\S)"+"(?!"+"[ ]{0,"+n+"}"+"(?:\\S.*\\n)+?"+"\\n?"+"[ ]{0,"+n+"}:[ ]+"+")"+"(?!"+"[ ]{0,"+n+"}:[ ]+"+")"+")"+")"+")"+")";return t=this.__wrapSTXETX__(t),t=t.replace(RegExp("(\\x02\\n?|\\n\\n)"+r,"mg"),function(t,n,r){var i=e._php_trim(e.processDefListItems(r));return i="<dl>\n"+i+"\n</dl>",n+e.hashBlock(i)+"\n\n"}),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.processDefListItems=function(t){var e=this,n=this.tab_width-1;return t=this.__wrapSTXETX__(t),t=t.replace(/\n{2,}(?=\\x03)/,"\n"),t=t.replace(RegExp("(\\x02\\n?|\\n\\n+)([ ]{0,"+n+"}"+"(?![:][ ]|[ ])"+"(?:\\S.*\\n)+?"+")"+"(?=\\n?[ ]{0,3}:[ ])","mg"),function(t,n,r){for(var i=e._php_trim(r).split("\n"),a="",o=0;i.length>o;o++){var s=i[o];s=e.runSpanGamut(e._php_trim(s)),a+="\n<dt>"+s+"</dt>"}return a+"\n"}),t=t.replace(RegExp("\\n(\\n+)?([ ]{0,"+n+"}"+"[:][ ]+"+")"+"([\\s\\S]+?)"+"(?=\\n*"+"(?:"+"\\n[ ]{0,"+n+"}[:][ ]|"+"<dt>|\\x03"+")"+")","mg"),function(t,n,r,i){return n||i.match(/\n{2,}/)?(i=e._php_str_repeat(" ",r.length)+i,i=e.runBlockGamut(e.outdent(i+"\n\n")),i="\n"+i+"\n"):(i=e._php_rtrim(i),i=e.runSpanGamut(e.outdent(i))),"\n<dd>"+i+"</dd>\n"}),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.doFencedCodeBlocks=function(t){var e=this;return this.tab_width,t=this.__wrapSTXETX__(t),t=t.replace(RegExp("(?:\\n|\\x02)(~{3,})[ ]*\\n((?:(?!\\1[ ]*\\n).*\\n+)+)\\1[ ]*\\n","mg"),function(t,n,r){return r=e._php_htmlspecialchars_ENT_NOQUOTES(r),r=r.replace(/^\n+/,function(t){return e._php_str_repeat("<br"+e.empty_element_suffix,t.length)}),r="<pre><code>"+r+"</code></pre>","\n\n"+e.hashBlock(r)+"\n\n"}),t=this.__unwrapSTXETX__(t)},MarkdownExtra_Parser.prototype.formParagraphs=function(t){t=this.__wrapSTXETX__(t),t=t.replace(/(?:\x02)\n+|\n+(?:\x03)/g,""),t=this.__unwrapSTXETX__(t);for(var e=t.split(/\n{2,}/m),n=0;e.length>n;n++){var r=e[n];if(""!=r){r=this._php_trim(this.runSpanGamut(r));var i=!r.match(/^B\x1A[0-9]+B|^C\x1A[0-9]+C$/);i&&(r="<p>"+r+"</p>"),e[n]=r}}return t=e.join("\n\n"),t=this.unhash(t)},MarkdownExtra_Parser.prototype.stripFootnotes=function(t){var e=this,n=this.tab_width-1;return t=t.replace(RegExp("^[ ]{0,"+n+"}\\[\\^(.+?)\\][ ]?:"+"[ ]*"+"\\n?"+"("+"(?:"+".+"+"|"+"\\n"+"(?!\\[\\^.+?\\]:\\s)"+"(?!\\n+[ ]{0,3}\\S)"+")*"+")","mg"),function(t,n,r){var i=e.fn_id_prefix+n;return e.footnotes[i]=e.outdent(r),""})},MarkdownExtra_Parser.prototype.doFootnotes=function(t){return this.in_anchor||(t=t.replace(/\[\^(.+?)\]/g,"Ffn:$1:")),t},MarkdownExtra_Parser.prototype.appendFootnotes=function(t){var e=this,n=function(t,n){var r=e.fn_id_prefix+n;if(r in e.footnotes){e.footnotes_ordered.push([r,e.footnotes[r]]),delete e.footnotes[r];var i=e.footnote_counter++,a=' rel="footnote"';if(""!=e.fn_link_class){var o=e.fn_link_class;o=e.encodeAttribute(o),a+=' class="'+o+'"'}if(""!=e.fn_link_title){var s=e.fn_link_title;s=e.encodeAttribute(s),a+=' title="'+s+'"'}return a=a.replace(/%%/g,i),r=e.encodeAttribute(r),'<sup id="fnref:'+r+'">'+'<a href="#fn:'+r+'"'+a+">"+i+"</a>"+"</sup>"}return"[^"+n+"]"};if(t=t.replace(/F\x1Afn:(.*?)\x1A:/g,n),this.footnotes_ordered.length>0){t+="\n\n",t+='<div class="footnotes">\n',t+="<hr"+this.empty_element_suffix+"\n",t+="<ol>\n\n";var r=' rev="footnote"';if(""!=this.fn_backlink_class){var i=this.fn_backlink_class;i=this.encodeAttribute(i),r+=' class="'+i+'"'}if(""!=this.fn_backlink_title){var a=this.fn_backlink_title;a=this.encodeAttribute(a),r+=' title="'+a+'"'}for(var o=0;this.footnotes_ordered.length>0;){var s=this.footnotes_ordered.shift(),h=s[0],u=s[1];u+="\n",u=this.runBlockGamut(u+"\n"),u=u.replace(/F\x1Afn:(.*?)\x1A:/g,n),r=r.replace(/%%/g,++o),h=this.encodeAttribute(h);var p='<a href="#fnref:'+h+'"'+r+">&#8617;</a>";u.match(/<\/p>$/)?u=u.substr(0,u.length-4)+"&#160;"+p+"</p>":u+="\n\n<p>"+p+"</p>",t+='<li id="fn:'+h+'">\n',t+=u+"\n",t+="</li>\n\n"}t+="</ol>\n",t+="</div>"}return t},MarkdownExtra_Parser.prototype.stripAbbreviations=function(t){var e=this,n=this.tab_width-1;return t=t.replace(RegExp("^[ ]{0,"+n+"}\\*\\[(.+?)\\][ ]?:"+"(.*)","m"),function(t,n,r){return""!=e.abbr_word_re&&(e.abbr_word_re+="|"),e.abbr_word_re+=e._php_preg_quote(n),e.abbr_desciptions[n]=e._php_trim(r),""})},MarkdownExtra_Parser.prototype.doAbbreviations=function(t){var e=this;return this.abbr_word_re&&(t=t.replace(RegExp("(^|[^\\w\\x1A])("+this.abbr_word_re+")"+"(?![\\w\\x1A])"),function(t,n,r){if(r in e.abbr_desciptions){var i=e.abbr_desciptions[r];return i&&""!=i?(i=e.encodeAttribute(i),e.hashPart('<abbr title="'+i+'">'+r+"</abbr>")):e.hashPart("<abbr>"+r+"</abbr>")}return t})),t},this.Markdown=Markdown,this.Markdown_Parser=Markdown_Parser,this.MarkdownExtra_Parser=MarkdownExtra_Parser;